import{V as t}from"./vendor.e0c7b3c9.js";import{C as i,n as e,a as o,d as r}from"./index.8a164fd8.js";import{P as a,W as n,G as s}from"./GenericView.dc1b57b0.js";import{A as l,B as d}from"./Button.5aa6d8be.js";import{F as c}from"./Faicon.ee0f96f8.js";var p={},g=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u=(t,i,e,o)=>{for(var r,a=o>1?void 0:o?h(i,e):i,n=t.length-1;n>=0;n--)(r=t[n])&&(a=(o?r(i,e,a):r(a))||a);return o&&a&&g(i,e,a),a};let b=class extends t{get iconStyle(){return{color:"#E0DEF7",width:"24px","font-size":"24px"}}get isSelected(){return this.siteId===this.selected}onClick(){this.selected<0&&this.$emit("select"),this.isSelected&&this.$emit("unselect")}handleState(t){try{t.nowState}catch(i){console.error(i.message)}}created(){this.$$created()}beforeDestroy(){this.$$beforeDestroy()}};u([a()],b.prototype,"protocal",2),u([a()],b.prototype,"name",2),u([a()],b.prototype,"server",2),u([a()],b.prototype,"siteId",2),u([a()],b.prototype,"selected",2),b=u([i({components:{Faicon:c}})],b);const m={};var f=e(b,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"site-card",on:{click:t.onClick}},[e("div",{staticClass:"pp-row-vc",staticStyle:{"border-bottom":"1px solid #333335","padding-bottom":"8px","justify-content":"space-between","margin-bottom":"8px"}},[e("div",{staticClass:"pp-row-vc",class:[t.isSelected?"selected":""]},[e("div",{staticClass:"protocal"},[t._v(t._s(t.protocal.toUpperCase()))]),e("div",{staticClass:"site-name"},[t._v(t._s(t.name))])]),t.selected<0?e("Faicon",{staticClass:"connect-icon",attrs:{name:"chevron-right",overwrrideStyle:{fontSize:"20px"}}}):t._e(),t.isSelected?e("Faicon",{staticClass:"connect-icon",attrs:{name:"xmark",overwrrideStyle:{fontSize:"20px"}}}):t._e()],1),e("div",{staticClass:"pp-row",staticStyle:{color:"#979BB4",gap:"60px"}},t._l(t.server,(function(i){return e("div",[e("div",{staticClass:"pp-row-vc"},[e("Faicon",{attrs:{name:"server",overwrrideStyle:t.iconStyle}}),e("span",{staticStyle:{"margin-left":"8px"}},[t._v("伺服器 "+t._s(i))])],1)])})),0)])}),[],!1,v,"4e5301bd",null,null);function v(t){for(let i in m)this[i]=m[i]}var _=function(){return f.exports}(),y=Object.defineProperty,S=Object.getOwnPropertyDescriptor,$=(t,i,e,o)=>{for(var r,a=o>1?void 0:o?S(i,e):i,n=t.length-1;n>=0;n--)(r=t[n])&&(a=(o?r(i,e,a):r(a))||a);return o&&a&&y(i,e,a),a};let x=class extends t{get iconStyle(){return{fontSize:"24px"}}onClick(){this.$emit("click")}handleState(t){try{t.nowState}catch(i){console.error(i.message)}}created(){this.$$created()}beforeDestroy(){this.$$beforeDestroy()}};$([a({default:""})],x.prototype,"logo",2),$([a({default:""})],x.prototype,"name",2),$([a({default:0})],x.prototype,"site",2),x=$([i({components:{Faicon:c}})],x);const w={};var C=e(x,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"account-card pp-row-vc",on:{click:t.onClick}},[e("img",{staticStyle:{height:"60px",width:"120px","object-fit":"contain"},attrs:{src:t.logo}}),e("div",[e("div",[t._v(t._s(t.name))]),e("div",[t._v("Site: "+t._s(t.site))])]),e("Faicon",{staticClass:"select-icon",attrs:{name:"chevron-right",overwrrideStyle:t.iconStyle}})],1)}),[],!1,k,"208714fc",null,null);function k(t){for(let i in w)this[i]=w[i]}var A=function(){return C.exports}(),O=Object.defineProperty,L=Object.getOwnPropertyDescriptor,j=(t,i,e,o)=>{for(var r,a=o>1?void 0:o?L(i,e):i,n=t.length-1;n>=0;n--)(r=t[n])&&(a=(o?r(i,e,a):r(a))||a);return o&&a&&O(i,e,a),a};let D=class extends t{constructor(){super(...arguments),this.showAccList_=!0,this.selectedAcc_=-1,this.selectedSite_=[],this.stores_=null,this.accounts_=[],this.name_="",this.icon_=""}get btnStyle(){return{backgroundColor:"#6C5DD3"}}get siteList(){var t;return((null==(t=this.stores_)?void 0:t.filter((t=>t.accountId===this.selectedAcc_)))||[]).map((t=>({asid:t.asid,name:t.name,siteId:t.storeId,server:t.aisMachines.map((t=>t.bisId)),protocal:t.aisMachines[0].networkSetting.protocol})))}get selectedSite(){var t;return(null==(t=this.selectedSite_[0])?void 0:t.siteId)||-1}onSelectedAccountIdChange(){this.selectedAcc_>0&&this.onSelect()}onSelectAccount(t){this.selectedAcc_=t}async onSelectSite(t){if(!this.stores_)return;const i=this.stores_.find((i=>i.asid===t));if(!i)return;const e=await o.selectStore(this.$$serverless(),{account:i.accountId,store:i.storeId},this.$$alias());console.log(e)}async onUnselectSite(){const t=await o.unselectStore(this.$$serverless(),{account:this.selectedAcc_,store:this.selectedSite_[0].siteId},this.$$alias());console.log(t)}async onLogout(){await o.logout(this.$$serverless(),this.$$alias()),this.$$fsm().change("LOGOUT")}async onSelect(){var t;const{userId:i}=await o.getLoginedUserId(this.$$serverless(),this.$$alias());if(!this.stores_||0===(null==(t=this.stores_)?void 0:t.length)){if(this.stores_=await r.getStore(this.$$serverless(),i,this.$$alias()),console.log(this.stores_),null===this.stores_)return console.error(`${this.$$alias()} stores not ready`),void this.$$fsm().change("LOGOUT");if(0===this.stores_.length){const t={result:!1,errno:403,message:"no permission"};return void this.$$fsm().change("LOGOUT",t)}}const e=this.stores_.filter((t=>t.accountId===this.selectedAcc_));await o.selectAccount(this.$$serverless(),i,e,this.$$alias())?this.$$fsm().change("SELECT"):this.$$fsm().change("LOGOUT")}async initialize(t){var i;t&&(this.stores_=t);const e=await this.$$select("SELECT * FROM tbl_aims_account;");this.accounts_=(null==(i=null==e?void 0:e.payload)?void 0:i.data)||[],1===this.accounts_.length&&(this.selectedAcc_=this.accounts_[0].account_id),this.name_=localStorage.getItem("userInfo-name")||"",this.icon_=localStorage.getItem("userInfo-icon")||""}handleState(t){try{switch(t.nowState){case"/main/home.account.list":this.showAccList_=!0;break;case"/main/home.site.list":this.showAccList_=!1}}catch(i){console.error(i.message)}}async created(){this.$$created(),this.initialize();await this.$$bridge("selectedSite_","\n      SELECT\n        pair.store_id as siteId\n      FROM tbl_user_store_pair as pair, tbl_aims_user as user\n      WHERE pair.user_id = user.user_id\n    ")}beforeDestroy(){this.$$beforeDestroy()}};j([n("selectedAcc_")],D.prototype,"onSelectedAccountIdChange",1),D=j([i({components:{Avatar:l,Faicon:c,Button:d,SiteCard:_,AccountCard:A}})],D);const I={};var F=e(D,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"pp-fit-100 container"},[e("div",{staticClass:"pp-row user-status user-status-height user-status-pd"},[e("div",{staticClass:"pp-row",staticStyle:{gap:"8px"}},[e("Avatar",{staticStyle:{width:"26px",height:"26px"},attrs:{image:"./img/avatars/"+t.icon_+".png"}}),e("div",{staticStyle:{color:"#FFFFFF"}},[t._v(t._s(t.name_))])],1),e("Button",{attrs:{overwrrideStyle:t.btnStyle,pressColor:"#6C5DD3",hoverColor:"#6C5DD3"},on:{onClick:t.onLogout},scopedSlots:t._u([{key:"icon-end",fn:function(){return[e("Faicon",{attrs:{name:"arrow-right-from-bracket"}})]},proxy:!0}])},[t._v(" 登出 ")])],1),e("div",{staticClass:"pp-scroll-mobile",staticStyle:{height:"calc(100% - 50px)"}},[t.showAccList_?t._l(t.accounts_,(function(i){return e("AccountCard",{key:i.account_id,staticClass:"user-status-pd",staticStyle:{"margin-bottom":"18px"},attrs:{name:i.name,logo:i.logo,site:i.store_qtt},on:{click:function(e){return t.onSelectAccount(i.account_id)}}})})):t._l(t.siteList,(function(i){return e("SiteCard",t._b({key:i.asid,staticClass:"user-status-pd",staticStyle:{width:"100%","margin-bottom":"18px"},attrs:{selected:t.selectedSite},on:{select:function(e){return t.onSelectSite(i.asid)},unselect:t.onUnselectSite}},"SiteCard",i,!1))}))],2)])}),[],!1,z,"440599b4",null,null);function z(t){for(let i in I)this[i]=I[i]}var E={Active:2,Layer:[{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"calc(100% - 83px)",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1}],Layout:[{"background-color":"initial",color:"initial",width:"320px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"600px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"100%",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"1264px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"1904px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1}],Grid:[[],[],[{x:0,y:0,r:-1,b:-1,w:"100%",h:"100%",comp:"LaptopMainHomeComp1",style:{"margin-top":"0px","margin-right":"0px","margin-bottom":"0px","margin-left":"0px","padding-top":"0px","padding-right":"0px","padding-bottom":"0px","padding-left":"0px","border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial","background-color":"#010101","box-shadow":"rgba(0, 0, 0, 0.1) 0 0 4px",opacity:1}}],[],[]],MxGrid:[0,0,1,0,0],MxSize:["Phone","Tablet","Laptop","Desktop","Ultra"],SubVue:[{tag:"LaptopMainHomeComp1",c:function(){return F.exports}()}],VGuides:[[],[],[],[],[]],HGuides:[[],[],[],[],[]]},G=Object.defineProperty,M=Object.getOwnPropertyDescriptor;let P=class extends t{constructor(){super(...arguments),this.vxmAction_=p,this.visualize_=E}handleState(t){try{t.nowState}catch(i){console.error(i.message)}}created(){this.$$created()}beforeDestroy(){this.$$beforeDestroy()}};P=((t,i,e,o)=>{for(var r,a=o>1?void 0:o?M(i,e):i,n=t.length-1;n>=0;n--)(r=t[n])&&(a=(o?r(i,e,a):r(a))||a);return o&&a&&G(i,e,a),a})([i({components:{GenericView:s}})],P);const V={};var U=e(P,(function(){var t=this,i=t.$createElement;return(t._self._c||i)("GenericView",{attrs:{VxMAction:t.vxmAction_,Visualize:t.visualize_},on:{"update:VxMAction":function(i){t.vxmAction_=i},"update:vx-m-action":function(i){t.vxmAction_=i},"update:Visualize":function(i){t.visualize_=i},"update:visualize":function(i){t.visualize_=i}}})}),[],!1,T,"54ba52b9",null,null);function T(t){for(let i in V)this[i]=V[i]}var B=function(){return U.exports}();export{B as default};
