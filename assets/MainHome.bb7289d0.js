import{V as t}from"./vendor.e0c7b3c9.js";import{C as i,n as e,a as r,d as o}from"./index.a8994edf.js";import{P as a,G as n}from"./GenericView.e7485d48.js";import{A as s,B as l}from"./Button.9ebf1276.js";import{F as c}from"./Faicon.deecf4a8.js";var d={},p=Object.defineProperty,g=Object.getOwnPropertyDescriptor,h=(t,i,e,r)=>{for(var o,a=r>1?void 0:r?g(i,e):i,n=t.length-1;n>=0;n--)(o=t[n])&&(a=(r?o(i,e,a):o(a))||a);return r&&a&&p(i,e,a),a};let u=class extends t{get iconStyle(){return{color:"#E0DEF7",width:"24px","font-size":"24px"}}get isSelected(){return this.siteId===this.selected}onClick(){this.selected<0&&this.$emit("select"),this.isSelected&&this.$emit("unselect")}handleState(t){try{t.nowState}catch(i){console.error(i.message)}}created(){this.$$created()}beforeDestroy(){this.$$beforeDestroy()}};h([a()],u.prototype,"protocal",2),h([a()],u.prototype,"name",2),h([a()],u.prototype,"server",2),h([a()],u.prototype,"siteId",2),h([a()],u.prototype,"selected",2),u=h([i({components:{Faicon:c}})],u);const b={};var m=e(u,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"site-card",on:{click:t.onClick}},[e("div",{staticClass:"pp-row-vc",staticStyle:{"border-bottom":"1px solid #333335","padding-bottom":"8px","justify-content":"space-between","margin-bottom":"8px"}},[e("div",{staticClass:"pp-row-vc",class:[t.isSelected?"selected":""]},[e("div",{staticClass:"protocal"},[t._v(t._s(t.protocal.toUpperCase()))]),e("div",{staticClass:"site-name"},[t._v(t._s(t.name))])]),t.selected<0?e("Faicon",{staticClass:"connect-icon",attrs:{name:"chevron-right",overwrrideStyle:{fontSize:"20px"}}}):t._e(),t.isSelected?e("Faicon",{staticClass:"connect-icon",attrs:{name:"xmark",overwrrideStyle:{fontSize:"20px"}}}):t._e()],1),e("div",{staticClass:"pp-row",staticStyle:{color:"#979BB4",gap:"60px"}},t._l(t.server,(function(i){return e("div",[e("div",{staticClass:"pp-row-vc"},[e("Faicon",{attrs:{name:"server",overwrrideStyle:t.iconStyle}}),e("span",{staticStyle:{"margin-left":"8px"}},[t._v("伺服器 "+t._s(i))])],1)])})),0)])}),[],!1,f,"03ba4f34",null,null);function f(t){for(let i in b)this[i]=b[i]}var v=function(){return m.exports}(),y=Object.defineProperty,_=Object.getOwnPropertyDescriptor,$=(t,i,e,r)=>{for(var o,a=r>1?void 0:r?_(i,e):i,n=t.length-1;n>=0;n--)(o=t[n])&&(a=(r?o(i,e,a):o(a))||a);return r&&a&&y(i,e,a),a};let S=class extends t{get iconStyle(){return{fontSize:"24px"}}onClick(){this.$emit("click")}handleState(t){try{t.nowState}catch(i){console.error(i.message)}}created(){this.$$created()}beforeDestroy(){this.$$beforeDestroy()}};$([a({default:""})],S.prototype,"logo",2),$([a({default:""})],S.prototype,"name",2),$([a({default:0})],S.prototype,"site",2),S=$([i({components:{Faicon:c}})],S);const x={};var w=e(S,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"account-card pp-row-vc",on:{click:t.onClick}},[e("img",{staticStyle:{height:"60px",width:"120px","object-fit":"contain"},attrs:{src:t.logo}}),e("div",[e("div",[t._v(t._s(t.name))]),e("div",[t._v("Site: "+t._s(t.site))])]),e("Faicon",{staticClass:"select-icon",attrs:{name:"chevron-right",overwrrideStyle:t.iconStyle}})],1)}),[],!1,C,"208714fc",null,null);function C(t){for(let i in x)this[i]=x[i]}var k=function(){return w.exports}(),A=Object.defineProperty,L=Object.getOwnPropertyDescriptor;let O=class extends t{constructor(){super(...arguments),this.showAccList_=!0,this.selectedAcc_=-1,this.selectedSite_=[],this.stores_=null,this.accounts_=[],this.name_="",this.icon_=""}get btnStyle(){return{backgroundColor:"#6C5DD3"}}get siteList(){var t;return((null==(t=this.stores_)?void 0:t.filter((t=>t.accountId===this.selectedAcc_)))||[]).map((t=>({asid:t.asid,name:t.name,siteId:t.storeId,server:t.aisMachines.map((t=>t.bisId)),protocal:t.aisMachines[0].networkSetting.protocol})))}get selectedSite(){var t;return(null==(t=this.selectedSite_[0])?void 0:t.siteId)||-1}async onBack(){r.unselectAccount(this.$$serverless(),this.$$alias()),this.$$fsm().change("ACCOUNT")}onSelectAccount(t){this.selectedAcc_=t,this.onSelect()}async onSelectSite(t){if(!this.stores_)return;const i=this.stores_.find((i=>i.asid===t));i&&await r.selectStore(this.$$serverless(),{account:i.accountId,store:i.storeId},this.$$alias())}async onUnselectSite(){await r.unselectStore(this.$$serverless(),{account:this.selectedAcc_,store:this.selectedSite_[0].siteId},this.$$alias())}async onLogout(){await r.logout(this.$$serverless(),this.$$alias()),this.$$fsm().change("LOGOUT")}async onSelect(){var t;const{userId:i}=await r.getLoginedUserId(this.$$serverless(),this.$$alias());if(!this.stores_||0===(null==(t=this.stores_)?void 0:t.length)){if(this.stores_=await o.getStore(this.$$serverless(),i,this.$$alias()),null===this.stores_)return console.error(`${this.$$alias()} stores not ready`),void this.$$fsm().change("LOGOUT");if(0===this.stores_.length){const t={result:!1,errno:403,message:"no permission"};return void this.$$fsm().change("LOGOUT",t)}}const e=this.stores_.filter((t=>t.accountId===this.selectedAcc_));await r.selectAccount(this.$$serverless(),i,e,this.$$alias())?(localStorage.setItem("user-account",`${this.selectedAcc_}`),this.$$fsm().change("SELECT")):this.$$fsm().change("LOGOUT")}async initialize(t){var i;t&&(this.stores_=t);const e=window.localStorage,a=+e.getItem("user-account");if(console.log(a),a>0){const{userId:t}=await r.getLoginedUserId(this.$$serverless(),this.$$alias());this.stores_=await o.getStore(this.$$serverless(),t,this.$$alias()),this.selectedAcc_=a,this.$$fsm().change("SELECT")}const n=await this.$$select("SELECT * FROM tbl_aims_account;");this.accounts_=(null==(i=null==n?void 0:n.payload)?void 0:i.data)||[],this.name_=e.getItem("userInfo-name")||"",this.icon_=e.getItem("userInfo-icon")||""}handleState(t){try{switch(t.nowState){case"/main/home.account.list":this.showAccList_=!0;break;case"/main/home.site.list":this.showAccList_=!1}}catch(i){console.error(i.message)}}async created(){this.$$created(),this.initialize();await this.$$bridge("selectedSite_","\n      SELECT\n        pair.store_id as siteId\n      FROM tbl_user_store_pair as pair, tbl_aims_user as user\n      WHERE pair.user_id = user.user_id\n    ")}beforeDestroy(){this.$$beforeDestroy()}};O=((t,i,e,r)=>{for(var o,a=r>1?void 0:r?L(i,e):i,n=t.length-1;n>=0;n--)(o=t[n])&&(a=(r?o(i,e,a):o(a))||a);return r&&a&&A(i,e,a),a})([i({components:{Avatar:s,Faicon:c,Button:l,SiteCard:v,AccountCard:k}})],O);const I={};var j=e(O,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"pp-fit-100 container"},[e("div",{staticClass:"pp-row user-status user-status-height user-status-pd"},[e("div",{staticClass:"pp-row",staticStyle:{gap:"8px"}},[e("Avatar",{staticStyle:{width:"26px",height:"26px"},attrs:{image:"./img/avatars/"+t.icon_+".png"}}),e("div",{staticStyle:{color:"#FFFFFF"}},[t._v(t._s(t.name_))])],1),e("Button",{attrs:{overwrrideStyle:t.btnStyle,pressColor:"#6C5DD3",hoverColor:"#6C5DD3"},on:{onClick:t.onLogout},scopedSlots:t._u([{key:"icon-end",fn:function(){return[e("Faicon",{attrs:{name:"arrow-right-from-bracket"}})]},proxy:!0}])},[t._v(" 登出 ")])],1),e("div",{staticClass:"pp-scroll-mobile",staticStyle:{height:"calc(100% - 50px)"}},[t.showAccList_?t._l(t.accounts_,(function(i){return e("AccountCard",{key:i.account_id,staticClass:"user-status-pd",staticStyle:{"margin-bottom":"18px"},attrs:{name:i.name,logo:i.logo,site:i.store_qtt},on:{click:function(e){return t.onSelectAccount(i.account_id)}}})})):[e("Button",{staticStyle:{"margin-bottom":"18px"},attrs:{overwrrideStyle:t.btnStyle,disabled:t.selectedSite>0},on:{onClick:t.onBack},scopedSlots:t._u([{key:"icon-start",fn:function(){return[e("Faicon",{attrs:{name:"chevron-left"}})]},proxy:!0}])},[t._v(" Back ")]),t._l(t.siteList,(function(i){return e("SiteCard",t._b({key:i.asid,staticClass:"user-status-pd",staticStyle:{width:"100%","margin-bottom":"18px"},attrs:{selected:t.selectedSite},on:{select:function(e){return t.onSelectSite(i.asid)},unselect:t.onUnselectSite}},"SiteCard",i,!1))}))]],2)])}),[],!1,D,"8115cb98",null,null);function D(t){for(let i in I)this[i]=I[i]}var F={Active:2,Layer:[{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"calc(100% - 83px)",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"#f6f8fc",color:"initial",width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex","justify-content":"center","align-items":"center","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1}],Layout:[{"background-color":"initial",color:"initial",width:"320px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"600px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"100%",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"1264px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1},{"background-color":"initial",color:"initial",width:"1904px",height:"100%","margin-top":0,"margin-right":0,"margin-bottom":0,"margin-left":0,"padding-top":0,"padding-right":0,"padding-bottom":0,"padding-left":0,"border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial",opacity:1}],Grid:[[],[],[{x:0,y:0,r:-1,b:-1,w:"100%",h:"100%",comp:"LaptopMainHomeComp1",style:{"margin-top":"0px","margin-right":"0px","margin-bottom":"0px","margin-left":"0px","padding-top":"0px","padding-right":"0px","padding-bottom":"0px","padding-left":"0px","border-top":"initial","border-right":"initial","border-bottom":"initial","border-left":"initial","border-top-left-radius":"initial","border-top-right-radius":"initial","border-bottom-left-radius":"initial","border-bottom-right-radius":"initial","background-color":"#010101","box-shadow":"rgba(0, 0, 0, 0.1) 0 0 4px",opacity:1}}],[],[]],MxGrid:[0,0,1,0,0],MxSize:["Phone","Tablet","Laptop","Desktop","Ultra"],SubVue:[{tag:"LaptopMainHomeComp1",c:function(){return j.exports}()}],VGuides:[[],[],[],[],[]],HGuides:[[],[],[],[],[]]},E=Object.defineProperty,z=Object.getOwnPropertyDescriptor;let G=class extends t{constructor(){super(...arguments),this.vxmAction_=d,this.visualize_=F}handleState(t){try{t.nowState}catch(i){console.error(i.message)}}created(){this.$$created()}beforeDestroy(){this.$$beforeDestroy()}};G=((t,i,e,r)=>{for(var o,a=r>1?void 0:r?z(i,e):i,n=t.length-1;n>=0;n--)(o=t[n])&&(a=(r?o(i,e,a):o(a))||a);return r&&a&&E(i,e,a),a})([i({components:{GenericView:n}})],G);const U={};var B=e(G,(function(){var t=this,i=t.$createElement;return(t._self._c||i)("GenericView",{attrs:{VxMAction:t.vxmAction_,Visualize:t.visualize_},on:{"update:VxMAction":function(i){t.vxmAction_=i},"update:vx-m-action":function(i){t.vxmAction_=i},"update:Visualize":function(i){t.visualize_=i},"update:visualize":function(i){t.visualize_=i}}})}),[],!1,M,"54ba52b9",null,null);function M(t){for(let i in U)this[i]=U[i]}var P=function(){return B.exports}();export{P as default};
